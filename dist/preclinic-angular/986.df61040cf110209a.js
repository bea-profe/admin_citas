"use strict";(self.webpackChunkpreclinic_angular=self.webpackChunkpreclinic_angular||[]).push([[986],{7986:(At,A,p)=>{p.r(A),p.d(A,{AppointmentModule:()=>vt});var m=p(6814),_=p(649),d=p(6676),t=(p(9930),p(9468)),c=p(9862),u=p(7876),q=p(3586);let v=(()=>{class i{showAppointmentAttention(e){throw new Error("Method not implemented.")}constructor(e,o){this.http=e,this.authService=o}listAppointments(e=1,o="",n="",a=null){let s=new c.WM({Authorization:"Bearer "+this.authService.token}),h="";return o&&(h+="&search="+o),n&&(h+="&specialitie_id="+n),a&&(h+="&date="+a),this.http.get(u.$g+"/appointment?page="+e+h,{headers:s})}listConfig(){let e=new c.WM({Authorization:"Bearer "+this.authService.token});return this.http.get(u.$g+"/appointment/config",{headers:e})}listPatient(e){let o=new c.WM({Authorization:"Bearer "+this.authService.token});return this.http.get(`${u.$g}/appointment/patient?dni=${e}`,{headers:o})}registerAppointment(e){let o=new c.WM({Authorization:"Bearer "+this.authService.token});return this.http.post(u.$g+"/appointment",e,{headers:o})}listFilter(e){let o=new c.WM({Authorization:"Bearer "+this.authService.token});return this.http.post(u.$g+"/appointment/filter",e,{headers:o})}showAppointment(e){let o=new c.WM({Authorization:"Bearer "+this.authService.token});return this.http.get(u.$g+"/appointment/"+e,{headers:o})}updateAppointment(e,o){let n=new c.WM({Authorization:"Bearer "+this.authService.token});return this.http.put(u.$g+"/appointment/"+e,o,{headers:n})}deleteAppointment(e){let o=new c.WM({Authorization:"Bearer "+this.authService.token});return this.http.delete(u.$g+"/appointment/"+e,{headers:o})}registerAttention(e){let o=new c.WM({Authorization:"Bearer "+this.authService.token});return this.http.post(u.$g+"/appointment-attendance",e,{headers:o})}showAppointmentAtendance(e){let o=new c.WM({Authorization:"Bearer "+this.authService.token});return this.http.get(u.$g+"/appointment-attendance/"+e,{headers:o})}static#t=this.\u0275fac=function(o){return new(o||i)(t.LFG(c.eN),t.LFG(q.e))};static#e=this.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var f=p(3680),g=p(3888),T=p(1043),Z=p(8525),l=p(95);function D(i,r){if(1&i&&(t.TgZ(0,"mat-option",44),t._uU(1),t.qZA()),2&i){const e=r.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function N(i,r){if(1&i&&(t.TgZ(0,"mat-option",44),t._uU(1),t.qZA()),2&i){const e=r.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function E(i,r){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"tr")(2,"td"),t._uU(3),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td")(7,"button",45),t.NdJ("click",function(){const a=t.CHM(e).$implicit,s=t.oxw();return t.KtG(s.showSegment(a))}),t._uU(8,"+"),t.qZA()()(),t.BQk()}if(2&i){const e=r.$implicit,o=t.oxw();t.xp6(3),t.Oqu(e.doctor.full_name),t.xp6(2),t.Oqu(o.countDisponibilidad(e))}}function J(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"input",48),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw(2);return t.KtG(a.selectSegment(n))}),t.qZA()}}function y(i,r){if(1&i&&(t.ynx(0),t.TgZ(1,"div",46)(2,"label"),t.YNc(3,J,1,0,"input",47),t._uU(4),t.qZA()(),t.BQk()),2&i){const e=r.$implicit;t.xp6(3),t.Q6J("ngIf",!e.is_appointment),t.xp6(1),t.AsE(" ",e.formatted_segment.formatted_hour_start," a ",e.formatted_segment.formatted_hour_end," ")}}function S(i,r){if(1&i&&(t.TgZ(0,"div",13)(1,"div",26)(2,"table",27)(3,"thead")(4,"tr")(5,"th"),t._uU(6,"Hora"),t.qZA()()(),t.TgZ(7,"tbody")(8,"tr")(9,"td"),t.YNc(10,y,5,3,"ng-container",28),t.qZA()()()()()()),2&i){const e=t.oxw();t.xp6(10),t.Q6J("ngForOf",e.DOCTOR_SELECTED.segments)}}function O(i,r){if(1&i&&(t.TgZ(0,"div",49)(1,"div",50)(2,"div",51)(3,"strong"),t._uU(4,"\xc9xito!"),t.qZA(),t._uU(5),t.TgZ(6,"button",52),t._UZ(7,"span",53),t.qZA()()()()),2&i){const e=t.oxw();t.xp6(5),t.hij(" ",e.text_success,". ")}}function k(i,r){if(1&i&&(t.TgZ(0,"div",49)(1,"div",50)(2,"div",54)(3,"strong"),t._uU(4,"\xa1Alerta!"),t.qZA(),t._uU(5),t.TgZ(6,"button",52),t._UZ(7,"span",53),t.qZA()()()()),2&i){const e=t.oxw();t.xp6(5),t.hij(" ",e.text_validation,". ")}}const b=function(){return{standalone:!0}};let w=(()=>{class i{constructor(e,o){this.appointmentService=e,this.dateAdapter=o,this.date_appointment=new Date,this.hours=[],this.specialities=[],this.name="",this.surname="",this.DNI="",this.movil="",this.amount=0,this.amount_add=0,this.method_payment="",this.DOCTORS=[],this.text_success="",this.text_validation="",this.dateFilter=n=>!!n&&d(n).isSameOrAfter(d(),"day"),this.date_appointment=new Date}ngOnInit(){d.locale("es"),d.tz.setDefault("Europe/Madrid"),this.dateAdapter.getFirstDayOfWeek=()=>1,this.fetchConfigData()}fetchConfigData(){this.appointmentService.listConfig().subscribe(e=>{this.hours=e.hours,this.specialities=e.specialities,console.log("Configuraci\xf3n cargada con \xe9xito")})}filtrar(){const e={date_appointment:d(this.date_appointment).format("YYYY-MM-DD"),hour:this.hour,specialitie_id:this.specialitie_id};this.appointmentService.listFilter(e).subscribe(o=>{this.DOCTORS=o.doctors})}countDisponibilidad(e){return e.segments.filter(n=>!n.is_appointment).length}showSegment(e){this.DOCTOR_SELECTED=e}selectSegment(e){this.selected_segment_hour=e}save(){if(!(this.name&&this.surname&&this.movil&&this.date_appointment&&this.specialitie_id&&this.selected_segment_hour))return void(this.text_validation="Todos los campos son obligatorios (HORA, FECHA, ESPECIALIDAD, PACIENTE)");const e=d(this.date_appointment).format("YYYY-MM-DD");this.appointmentService.registerAppointment({doctor_id:this.DOCTOR_SELECTED&&this.DOCTOR_SELECTED.doctor?this.DOCTOR_SELECTED.doctor.id:null,name:this.name,surname:this.surname,movil:this.movil,DNI:this.DNI,date_appointment:e,specialitie_id:this.specialitie_id,doctor_schedule_join_id:this.selected_segment_hour?this.selected_segment_hour.id:null}).subscribe(s=>{this.text_success="La cita m\xe9dica se registr\xf3 correctamente."})}dnifilter(){this.appointmentService.listPatient(this.DNI).subscribe(e=>{403==e.message?(this.name="",this.surname="",this.movil="",this.DNI=""):(this.name=e.name,this.surname=e.surname,this.movil=e.movil,this.DNI=e.DNI)})}static#t=this.\u0275fac=function(o){return new(o||i)(t.Y36(v),t.Y36(f._A))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-add-appointments"]],decls:108,vars:20,consts:[[1,"page-wrapper"],[1,"content"],[1,"page-header"],[1,"row"],[1,"col-sm-12"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],[1,"feather","icon-chevron-right"],[1,"breadcrumb-item","active"],[1,"card"],[1,"card-body"],[1,"row","align-items-center"],[1,"col-12"],[1,"form-heading"],[1,"col-12","col-md-6","col-xl-3"],[1,"form-group","local-forms"],["for","fecha_nac"],[1,"login-danger"],["name","fecha_nac","type","text","matInput","","placeholder","Seleccione una fecha","autocomplete","off","required","",1,"form-control","datetimepicker",3,"ngModel","matDatepicker","matDatepickerFilter","ngModelChange"],["matSuffix","",3,"for"],["picker",""],["placeholder","Seleccionar Hora",1,"form-control","select",3,"ngModel","ngModelOptions","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["placeholder","Seleccionar Especialidad",1,"form-control","select",3,"ngModel","ngModelOptions","ngModelChange"],[1,"btn","btn-sm","btn-primary",3,"click"],[1,"table-responsive"],[1,"table","mb-0"],[4,"ngFor","ngForOf"],["class","col-12",4,"ngIf"],["class","form-group row my-4",4,"ngIf"],[1,"row","align-items-center","py-4"],[1,"col-12","py-4"],[1,"col-12","col-md-6","col-xl-4"],["for","name"],["name","name","type","text",1,"form-control",3,"ngModel","ngModelChange"],["for","surname"],["name","surname","type","text",1,"form-control",3,"ngModel","ngModelChange"],["for","dni"],["name","DNI","type","text",1,"form-control",3,"ngModel","keyup.enter","ngModelChange"],["for","movil"],["name","movil","type","text",1,"form-control",3,"ngModel","ngModelChange"],[1,"doctor-submit","text-end"],["type","button",1,"btn","btn-primary","submit-form","me-2",3,"click"],[3,"value"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"radio"],["type","radio","name","radio",3,"click",4,"ngIf"],["type","radio","name","radio",3,"click"],[1,"form-group","row","my-4"],[1,"col-md-8"],["role","alert",1,"alert","alert-success","alert-dismissible","fade","show"],["type","button","data-bs-dismiss","alert","aria-label","Close",1,"btn-close"],["aria-hidden","true"],["role","alert",1,"alert","alert-warning","alert-dismissible","fade","show"]],template:function(o,n){if(1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"ul",5)(6,"li",6)(7,"a",7),t._uU(8,"Citas m\xe9dicas"),t.qZA()(),t.TgZ(9,"li",6),t._UZ(10,"i",8),t.qZA(),t.TgZ(11,"li",9),t._uU(12,"A\xf1adir Citas"),t.qZA()()()()(),t.TgZ(13,"div",3)(14,"div",4)(15,"div",10)(16,"div",11)(17,"form")(18,"div",12)(19,"div",13)(20,"div",14)(21,"h4"),t._uU(22,"Datos cita"),t.qZA()()(),t.TgZ(23,"div",15)(24,"div",16)(25,"label",17),t._uU(26,"Fecha de la cita "),t.TgZ(27,"span",18),t._uU(28,"*"),t.qZA()(),t.TgZ(29,"input",19),t.NdJ("ngModelChange",function(s){return n.date_appointment=s}),t.qZA(),t._UZ(30,"mat-datepicker-toggle",20)(31,"mat-datepicker",null,21),t.qZA()(),t.TgZ(33,"div",15)(34,"div",16)(35,"label"),t._uU(36,"Hora "),t.TgZ(37,"span",18),t._uU(38,"*"),t.qZA()(),t.TgZ(39,"mat-select",22),t.NdJ("ngModelChange",function(s){return n.hour=s}),t.YNc(40,D,2,2,"mat-option",23),t.qZA()()(),t.TgZ(41,"div",15)(42,"div",16)(43,"label"),t._uU(44,"Especialidades "),t.TgZ(45,"span",18),t._uU(46,"*"),t.qZA()(),t.TgZ(47,"mat-select",24),t.NdJ("ngModelChange",function(s){return n.specialitie_id=s}),t.YNc(48,N,2,2,"mat-option",23),t.qZA()()(),t.TgZ(49,"div",15)(50,"div",16)(51,"button",25),t.NdJ("click",function(){return n.filtrar()}),t._uU(52,"Filtrar"),t.qZA()()()(),t.TgZ(53,"div",12)(54,"div",13)(55,"div",26)(56,"table",27)(57,"thead")(58,"tr")(59,"th"),t._uU(60,"Doctor"),t.qZA(),t.TgZ(61,"th"),t._uU(62,"Disponibilidad"),t.qZA(),t.TgZ(63,"th"),t._uU(64,"Ver"),t.qZA()()(),t.TgZ(65,"tbody"),t.YNc(66,E,9,2,"ng-container",28),t.qZA()()()(),t.YNc(67,S,11,1,"div",29),t.qZA(),t.TgZ(68,"div",13),t.YNc(69,O,8,1,"div",30),t.YNc(70,k,8,1,"div",30),t.qZA(),t.TgZ(71,"div",31)(72,"div",32)(73,"h4"),t._uU(74,"Datos del paciente"),t.qZA()(),t.TgZ(75,"div",33)(76,"div",16)(77,"label",34),t._uU(78,"Nombre "),t.TgZ(79,"span",18),t._uU(80,"*"),t.qZA()(),t.TgZ(81,"input",35),t.NdJ("ngModelChange",function(s){return n.name=s}),t.qZA()()(),t.TgZ(82,"div",33)(83,"div",16)(84,"label",36),t._uU(85,"Apellidos "),t.TgZ(86,"span",18),t._uU(87,"*"),t.qZA()(),t.TgZ(88,"input",37),t.NdJ("ngModelChange",function(s){return n.surname=s}),t.qZA()()(),t.TgZ(89,"div",33)(90,"div",16)(91,"label",38),t._uU(92,"DNI "),t.TgZ(93,"span",18),t._uU(94,"*"),t.qZA()(),t.TgZ(95,"input",39),t.NdJ("keyup.enter",function(){return n.dnifilter()})("ngModelChange",function(s){return n.DNI=s}),t.qZA()()(),t.TgZ(96,"div",33)(97,"div",16)(98,"label",40),t._uU(99,"M\xf3vil "),t.TgZ(100,"span",18),t._uU(101,"*"),t.qZA()(),t.TgZ(102,"input",41),t.NdJ("ngModelChange",function(s){return n.movil=s}),t.qZA()()()(),t.TgZ(103,"div",12)(104,"div",13)(105,"div",42)(106,"button",43),t.NdJ("click",function(){return n.save()}),t._uU(107,"Guardar"),t.qZA()()()()()()()()()()()),2&o){const a=t.MAs(32);t.xp6(29),t.Q6J("ngModel",n.date_appointment)("matDatepicker",a)("matDatepickerFilter",n.dateFilter),t.xp6(1),t.Q6J("for",a),t.xp6(9),t.Q6J("ngModel",n.hour)("ngModelOptions",t.DdM(18,b)),t.xp6(1),t.Q6J("ngForOf",n.hours),t.xp6(7),t.Q6J("ngModel",n.specialitie_id)("ngModelOptions",t.DdM(19,b)),t.xp6(1),t.Q6J("ngForOf",n.specialities),t.xp6(18),t.Q6J("ngForOf",n.DOCTORS),t.xp6(1),t.Q6J("ngIf",n.DOCTOR_SELECTED),t.xp6(2),t.Q6J("ngIf",n.text_success),t.xp6(1),t.Q6J("ngIf",n.text_validation),t.xp6(11),t.Q6J("ngModel",n.name),t.xp6(7),t.Q6J("ngModel",n.surname),t.xp6(7),t.Q6J("ngModel",n.DNI),t.xp6(7),t.Q6J("ngModel",n.movil)}},dependencies:[m.sg,m.O5,g.Mq,g.hl,g.nW,T.R9,Z.gD,f.ey,l._Y,l.Fj,l.JJ,l.JL,l.Q7,l.On,l.F]})}return i})(),I=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-appointment"]],decls:1,vars:0,template:function(o,n){1&o&&t._UZ(0,"router-outlet")},dependencies:[_.lC]})}return i})();function F(i,r){if(1&i&&(t.TgZ(0,"div",42)(1,"div",43)(2,"div",44)(3,"strong"),t._uU(4,"\xa1\xc9xito!"),t.qZA(),t._uU(5),t.TgZ(6,"button",45),t._UZ(7,"span",46),t.qZA()()()()),2&i){const e=t.oxw();t.xp6(5),t.hij(" ",e.text_success,". ")}}function L(i,r){if(1&i&&(t.TgZ(0,"div",42)(1,"div",43)(2,"div",47)(3,"strong"),t._uU(4,"\xa1Atenci\xf3n!"),t.qZA(),t._uU(5),t.TgZ(6,"button",45),t._UZ(7,"span",46),t.qZA()()()()),2&i){const e=t.oxw();t.xp6(5),t.hij(" ",e.text_validation,". ")}}function Q(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t._UZ(3,"br"),t._uU(4),t.qZA(),t.TgZ(5,"td")(6,"button",48),t.NdJ("click",function(){const a=t.CHM(e).index,s=t.oxw();return t.KtG(s.deleteMedicamento(a))}),t._uU(7,"Eliminar"),t.qZA()()()}if(2&i){const e=r.$implicit;t.xp6(2),t.hij(" Tratamiento: ",e.prescription," "),t.xp6(2),t.hij(" Forma de uso: ",e.uso," ")}}function Y(i,r){if(1&i&&(t.TgZ(0,"div",42)(1,"div",43)(2,"div",44)(3,"strong"),t._uU(4,"Exito!"),t.qZA(),t._uU(5),t.TgZ(6,"button",45),t._UZ(7,"span",46),t.qZA()()()()),2&i){const e=t.oxw();t.xp6(5),t.hij(" ",e.text_success,". ")}}function P(i,r){if(1&i&&(t.TgZ(0,"div",42)(1,"div",43)(2,"div",47)(3,"strong"),t._uU(4,"!"),t.qZA(),t._uU(5),t.TgZ(6,"button",45),t._UZ(7,"span",46),t.qZA()()()()),2&i){const e=t.oxw();t.xp6(5),t.hij(" ",e.text_validation,". ")}}let R=(()=>{class i{constructor(e,o){this.appointmentService=e,this.activatedRoute=o,this.name="",this.surname="",this.DNI="",this.movil="",this.text_success="",this.text_validation="",this.medical=[]}ngOnInit(){this.activatedRoute.params.subscribe(e=>{console.log(e),this.appointment_id=e.id}),this.appointmentService.showAppointment(this.appointment_id).subscribe(e=>{console.log(e),this.appointment_selected=e.appointment,this.name=this.appointment_selected.patient.name,this.surname=this.appointment_selected.patient.surname,this.movil=this.appointment_selected.patient.movil,this.DNI=this.appointment_selected.patient.DNI}),this.appointmentService.showAppointmentAtendance(this.appointment_id).subscribe(e=>{console.log(e),this.appointment_attendance_selected=e.appointment_attention,this.medical=this.appointment_attendance_selected?.prescription,this.description=this.appointment_attendance_selected?.description})}loadAppointmentDetails(){this.appointmentService.showAppointment(this.appointment_id).subscribe(e=>{console.log(e),this.appointment_selected=e.appointment,this.name=this.appointment_selected.patient.name,this.surname=this.appointment_selected.patient.surname,this.movil=this.appointment_selected.patient.movil,this.DNI=this.appointment_selected.patient.DNI},e=>{console.error("Error fetching appointment details",e)})}loadAppointmentAttendance(){this.appointmentService.showAppointmentAtendance(this.appointment_id).subscribe(e=>{console.log(e),this.appointment_attendance_selected=e.appointment_attendance,this.medical=this.appointment_attendance_selected?.prescription,this.description=this.appointment_attendance_selected?.description},e=>{console.error("Error fetching appointment attendance",e)})}addMedicamento(){this.medical.push({prescription:this.prescription,uso:this.uso}),this.uso="",this.prescription=""}deleteMedicamento(e){this.medical.splice(e,1)}save(){if(console.log("Entering save method"),console.log("description :",this.description),console.log("prescription :",this.prescription),console.log("uso :",this.uso),console.log("medical:",this.medical),console.log("appointment_id:",this.appointment_id),console.log("description.length:",this.description.length),console.log("medical.length:",this.medical.length),!this.description||0===this.medical.length)return void(this.text_validation="Es necesario que introduzca el diagn\xf3stico y una receta m\xe9dica");let e={appointment_id:this.appointment_id,patient_id:this.appointment_selected.patient_id,description:this.description,medical:this.medical};console.log("Data to be sent:",e),this.isLoading=!0,this.text_validation="",this.text_success="",this.appointmentService.registerAttention(e).subscribe(o=>{console.log(o),this.text_success="Se guard\xf3 la informaci\xf3n de la atenci\xf3n m\xe9dica",this.isLoading=!1},o=>{console.error(o),this.text_validation="Ocurri\xf3 un error al guardar la informaci\xf3n",this.isLoading=!1})}static#t=this.\u0275fac=function(o){return new(o||i)(t.Y36(v),t.Y36(_.gz))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-attendance"]],decls:103,vars:14,consts:[[1,"page-wrapper"],[1,"content"],[1,"page-header"],[1,"row"],[1,"col-sm-12"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],[1,"feather","icon-chevron-right"],[1,"breadcrumb-item","active"],[1,"card"],[1,"card-body"],[1,"row","align-items-center"],[1,"col-12"],[1,"form-heading"],["class","form-group row my-4",4,"ngIf"],[1,"row","align-items-center","py-4","mb-3"],[1,"col-12","py-4"],[1,"col-12","col-md-6","col-xl-4"],[1,"form-group","local-forms"],["for","name"],[1,"login-danger"],["disabled","","name","name","type","text",1,"form-control",3,"ngModel","ngModelChange"],["for","surname"],["disabled","","name","surname","type","text",1,"form-control",3,"ngModel","ngModelChange"],["for","dni"],["disabled","","name","DNI","type","text",1,"form-control",3,"ngModel","ngModelChange"],["for","user"],["disabled","","name","movil","type","text",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-12","col-sm-12"],["for","designation"],["name","description","rows","4","cols","30",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-6"],[1,"col-12","mb-3"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],["name","prescription","type","text",1,"form-control",3,"ngModel","ngModelChange"],["name","uso","type","text",1,"form-control",3,"ngModel","ngModelChange"],[1,"table-responsive"],[1,"table","mb-0"],[4,"ngFor","ngForOf"],[1,"doctor-submit","text-end"],["type","button",1,"btn","btn-primary","submit-form","me-2",3,"click"],[1,"form-group","row","my-4"],[1,"col-md-8"],["role","alert",1,"alert","alert-success","alert-dismissible","fade","show"],["type","button","data-bs-dismiss","alert","aria-label","Close",1,"btn-close"],["aria-hidden","true"],["role","alert",1,"alert","alert-warning","alert-dismissible","fade","show"],["type","button",1,"btn","btn-danger","btn-sm",3,"click"]],template:function(o,n){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"ul",5)(6,"li",6)(7,"a",7),t._uU(8,"Consulta m\xe9dica"),t.qZA()(),t.TgZ(9,"li",6),t._UZ(10,"i",8),t.qZA(),t.TgZ(11,"li",9),t._uU(12),t.qZA()()()()(),t.TgZ(13,"div",3)(14,"div",4)(15,"div",10)(16,"div",11)(17,"form")(18,"div",12)(19,"div",13)(20,"div",14)(21,"h4"),t._uU(22,"Formulario consulta m\xe9dica"),t.qZA()()()(),t.TgZ(23,"div",13),t.YNc(24,F,8,1,"div",15),t.YNc(25,L,8,1,"div",15),t.qZA(),t.TgZ(26,"div",16)(27,"div",17)(28,"h4"),t._uU(29,"Datos del paciente"),t.qZA()(),t.TgZ(30,"div",18)(31,"div",19)(32,"label",20),t._uU(33,"Nombre "),t.TgZ(34,"span",21),t._uU(35,"*"),t.qZA()(),t.TgZ(36,"input",22),t.NdJ("ngModelChange",function(s){return n.name=s}),t.qZA()()(),t.TgZ(37,"div",18)(38,"div",19)(39,"label",23),t._uU(40,"Apellidos "),t.TgZ(41,"span",21),t._uU(42,"*"),t.qZA()(),t.TgZ(43,"input",24),t.NdJ("ngModelChange",function(s){return n.surname=s}),t.qZA()()(),t.TgZ(44,"div",18)(45,"div",19)(46,"label",25),t._uU(47,"DNI "),t.TgZ(48,"span",21),t._uU(49,"*"),t.qZA()(),t.TgZ(50,"input",26),t.NdJ("ngModelChange",function(s){return n.DNI=s}),t.qZA()()(),t.TgZ(51,"div",18)(52,"div",19)(53,"label",27),t._uU(54,"M\xf3vil "),t.TgZ(55,"span",21),t._uU(56,"*"),t.qZA()(),t.TgZ(57,"input",28),t.NdJ("ngModelChange",function(s){return n.movil=s}),t.qZA()()(),t.TgZ(58,"div",29)(59,"div",19)(60,"label",30),t._uU(61,"Diagn\xf3stico "),t.TgZ(62,"span",21),t._uU(63,"*"),t.qZA()(),t.TgZ(64,"textarea",31),t.NdJ("ngModelChange",function(s){return n.description=s}),t.qZA()()()(),t.TgZ(65,"div",12)(66,"div",32)(67,"div",3)(68,"div",33)(69,"button",34),t.NdJ("click",function(){return n.addMedicamento()}),t._uU(70,"Agregar Tratamiento"),t.qZA()(),t.TgZ(71,"div",33)(72,"div",19)(73,"label"),t._uU(74,"Tratamiento "),t._UZ(75,"span",21),t.qZA(),t.TgZ(76,"input",35),t.NdJ("ngModelChange",function(s){return n.prescription=s}),t.qZA()()(),t.TgZ(77,"div",13)(78,"div",19)(79,"label"),t._uU(80,"Indicaciones "),t.TgZ(81,"span",21),t._uU(82,"*"),t.qZA()(),t.TgZ(83,"input",36),t.NdJ("ngModelChange",function(s){return n.uso=s}),t.qZA()()()()(),t.TgZ(84,"div",32)(85,"div",37)(86,"table",38)(87,"thead")(88,"tr")(89,"th"),t._uU(90,"Descripci\xf3n"),t.qZA(),t.TgZ(91,"th"),t._uU(92,"Acci\xf3n"),t.qZA()()(),t.TgZ(93,"tbody"),t.YNc(94,Q,8,2,"tr",39),t.qZA()()()()(),t.TgZ(95,"div",12)(96,"div",13),t.YNc(97,Y,8,1,"div",15),t.YNc(98,P,8,1,"div",15),t.qZA(),t.TgZ(99,"div",13)(100,"div",40)(101,"button",41),t.NdJ("click",function(){return n.save()}),t._uU(102," Guardar "),t.qZA()()()()()()()()()()()),2&o&&(t.xp6(12),t.AsE("Consulta ",n.name," ",n.surname,""),t.xp6(12),t.Q6J("ngIf",n.text_success),t.xp6(1),t.Q6J("ngIf",n.text_validation),t.xp6(11),t.Q6J("ngModel",n.name),t.xp6(7),t.Q6J("ngModel",n.surname),t.xp6(7),t.Q6J("ngModel",n.DNI),t.xp6(7),t.Q6J("ngModel",n.movil),t.xp6(7),t.Q6J("ngModel",n.description),t.xp6(12),t.Q6J("ngModel",n.prescription),t.xp6(7),t.Q6J("ngModel",n.uso),t.xp6(11),t.Q6J("ngForOf",n.medical),t.xp6(3),t.Q6J("ngIf",n.text_success),t.xp6(1),t.Q6J("ngIf",n.text_validation))},dependencies:[m.sg,m.O5,l._Y,l.Fj,l.JJ,l.JL,l.On,l.F]})}return i})();function j(i,r){if(1&i&&(t.TgZ(0,"mat-option",46),t._uU(1),t.qZA()),2&i){const e=r.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function z(i,r){if(1&i&&(t.TgZ(0,"mat-option",46),t._uU(1),t.qZA()),2&i){const e=r.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function G(i,r){if(1&i&&(t.TgZ(0,"div",27)(1,"div",28)(2,"table",29)(3,"thead")(4,"tr")(5,"th"),t._uU(6,"DOCTOR"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"HORARIO PACTADA"),t.qZA()()(),t.TgZ(9,"tbody")(10,"tr",47)(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA()()()()()()),2&i){const e=t.oxw();t.xp6(12),t.Oqu(e.appointment_selected.doctor.full_name),t.xp6(2),t.AsE(" ",e.appointment_selected.segment_hour.formatted_segment.formatted_hour_start," a ",e.appointment_selected.segment_hour.formatted_segment.formatted_hour_end," ")}}const B=function(i){return{"bg-danger":i}};function H(i,r){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"tr",48)(2,"td"),t._uU(3),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td")(7,"button",49),t.NdJ("click",function(){const a=t.CHM(e).$implicit,s=t.oxw();return t.KtG(s.showSegment(a))}),t._uU(8," + "),t.qZA()()(),t.BQk()}if(2&i){const e=r.$implicit,o=t.oxw();t.xp6(1),t.Q6J("ngClass",t.VKq(3,B,o.isDoctorMatch(e))),t.xp6(2),t.Oqu(e.doctor.full_name),t.xp6(2),t.Oqu(o.countDisponibilidad(e))}}function K(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"input",53),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw(2);return t.KtG(a.selectSegment(n))}),t.qZA()}}function W(i,r){if(1&i&&(t.ynx(0),t.TgZ(1,"div",51)(2,"label"),t.YNc(3,K,1,0,"input",52),t._uU(4),t.qZA()(),t.BQk()),2&i){const e=r.$implicit;t.xp6(3),t.Q6J("ngIf",!e.is_appointment),t.xp6(1),t.AsE(" ",e.formatted_segment.formatted_hour_start," a ",e.formatted_segment.formatted_hour_end," ")}}function V(i,r){if(1&i&&(t.TgZ(0,"div",50)(1,"div",28)(2,"table",29)(3,"thead")(4,"tr")(5,"th"),t._uU(6,"Hora"),t.qZA()()(),t.TgZ(7,"tbody")(8,"tr")(9,"td"),t.YNc(10,W,5,3,"ng-container",30),t.qZA()()()()()()),2&i){const e=t.oxw();t.xp6(10),t.Q6J("ngForOf",e.DOCTOR_SELECTED.segments)}}function X(i,r){if(1&i&&(t.TgZ(0,"div",54)(1,"div",55)(2,"div",56)(3,"strong"),t._uU(4,"Exito!"),t.qZA(),t._uU(5),t.TgZ(6,"button",57),t._UZ(7,"span",58),t.qZA()()()()),2&i){const e=t.oxw();t.xp6(5),t.hij(" ",e.text_success,". ")}}function tt(i,r){if(1&i&&(t.TgZ(0,"div",54)(1,"div",55)(2,"div",59)(3,"strong"),t._uU(4,"!"),t.qZA(),t._uU(5),t.TgZ(6,"button",57),t._UZ(7,"span",58),t.qZA()()()()),2&i){const e=t.oxw();t.xp6(5),t.hij(" ",e.text_validation,". ")}}const C=function(){return{standalone:!0}};let et=(()=>{class i{constructor(e,o,n){this.appointmentService=e,this.activatedRoute=o,this.dateAdapter=n,this.hours=[],this.specialities=[],this.date_appointment=new Date,this.hour=[],this.name="",this.surname="",this.DNI="",this.movil="",this.amount=0,this.amount_add=0,this.method_payment="",this.DOCTORS=[],this.text_success="",this.text_validation="",this.dateFilter=a=>!!a&&d(a).isSameOrAfter(d(),"day"),this.date_appointment=new Date}ngOnInit(){d.locale("es"),d.tz.setDefault("Europe/Madrid"),this.dateAdapter.getFirstDayOfWeek=()=>1,this.activatedRoute.params.subscribe(e=>{console.log(e),this.appointment_id=e.id}),this.appointmentService.listConfig().subscribe(e=>{this.hours=e.hours,this.specialities=e.specialities,this.appointmentService.showAppointment(this.appointment_id).subscribe(o=>{console.log(o),this.appointment_selected=o.appointment,this.name=this.appointment_selected.patient.name,this.surname=this.appointment_selected.patient.surname,this.movil=this.appointment_selected.patient.movil,this.DNI=this.appointment_selected.patient.DNI,this.specialitie_id=this.appointment_selected.specialitie_id,this.hour=this.appointment_selected.segment_hour.formatted_segment.hour})})}filtrar(){const e={date_appointment:d(this.date_appointment).format("YYYY-MM-DD"),hour:this.hour,specialitie_id:this.specialitie_id};this.appointmentService.listFilter(e).subscribe(o=>{console.log(o),this.DOCTORS=o.doctors})}isDoctorMatch(e){return e.doctor.id===this.appointment_selected.doctor_id}isSegmentMatch(e){return e.id===this.appointment_selected.doctor_schedule_join_hour_id}countDisponibilidad(e){return e.segments.filter(n=>!n.is_appointment).length}showSegment(e){this.DOCTOR_SELECTED=e}selectSegment(e){this.selected_segment_hour=e}resetDoctorSelection(e){this.DOCTORS=[],this.selected_segment_hour=null,this.DOCTOR_SELECTED=null}save(){if(this.text_validation="",!this.date_appointment||!this.specialitie_id)return void(this.text_validation="Los campos son necesarios (fecha y especialidad).");if(new Date(this.date_appointment).getTime()!==new Date(this.appointment_selected.date_appointment).getTime()&&!this.selected_segment_hour)return void(this.text_validation="Seleccione una franja horaria diferente.");const e=d(this.date_appointment).format("YYYY-MM-DD");this.appointmentService.updateAppointment(this.appointment_id,{doctor_id:this.DOCTOR_SELECTED.doctor.id,date_appointment:e,specialitie_id:this.specialitie_id,doctor_schedule_join_id:this.selected_segment_hour.id?this.selected_segment_hour.id:this.appointment_selected.doctor_schedule_join_id}).subscribe(n=>{console.log(n),this.text_success="La cita m\xe9dica se actualiz\xf3 correctamente."})}dnifilter(){this.appointmentService.listPatient(this.DNI).subscribe(e=>{console.log(e),403==e.message?(this.name="",this.surname="",this.movil="",this.DNI=""):(this.name=e.name,this.surname=e.surname,this.movil=e.movil,this.DNI=e.DNI)})}static#t=this.\u0275fac=function(o){return new(o||i)(t.Y36(v),t.Y36(_.gz),t.Y36(f._A))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-edit-appointments"]],decls:111,vars:21,consts:[[1,"page-wrapper"],[1,"content"],[1,"page-header"],[1,"row"],[1,"col-sm-12"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],[1,"feather","icon-chevron-right"],[1,"breadcrumb-item","active"],[1,"card"],[1,"card-body"],[1,"row","align-items-center"],[1,"col-12"],[1,"form-heading"],[1,"col-12","col-md-6","col-xl-3"],[1,"form-group","local-forms"],["for","fecha_nac"],[1,"login-danger"],["name","fecha_nac","type","text","matInput","","placeholder","Seleccione una fecha","autocomplete","off","required","",1,"form-control","datetimepicker",3,"ngModel","matDatepicker","matDatepickerFilter","ngModelChange"],["matSuffix","",3,"for"],["picker",""],["placeholder","Select  Hour",1,"form-control","select",3,"ngModel","ngModelOptions","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["placeholder","Selecccionar Especialidad",1,"form-control","select",3,"ngModel","ngModelOptions","ngModelChange"],[1,"btn","btn-sm","btn-primary",3,"click"],["class","col-8",4,"ngIf"],[1,"col-8"],[1,"table-responsive"],[1,"table","mb-0"],[4,"ngFor","ngForOf"],["class","col-4",4,"ngIf"],["class","form-group row my-4",4,"ngIf"],[1,"row","align-items-center","py-4"],[1,"col-12","py-4"],[1,"col-12","col-md-6","col-xl-4"],["for","name"],["disabled","","name","name","type","text",1,"form-control",3,"ngModel","ngModelChange"],["for","surname"],["disabled","","name","surname","type","text",1,"form-control",3,"ngModel","ngModelChange"],["for","dni"],["disabled","","name","DNI","type","text",1,"form-control",3,"ngModel","keyup.enter","ngModelChange"],["for","user"],["disabled","","name","movil","type","text",1,"form-control",3,"ngModel","ngModelChange"],[1,"doctor-submit","text-end"],["type","button",1,"btn","btn-primary","submit-form","me-2",3,"click"],[3,"value"],[1,"bg-danger"],[3,"ngClass"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"col-4"],[1,"radio"],["type","radio","name","radio",3,"click",4,"ngIf"],["type","radio","name","radio",3,"click"],[1,"form-group","row","my-4"],[1,"col-md-8"],["role","alert",1,"alert","alert-success","alert-dismissible","fade","show"],["type","button","data-bs-dismiss","alert","aria-label","Close",1,"btn-close"],["aria-hidden","true"],["role","alert",1,"alert","alert-warning","alert-dismissible","fade","show"]],template:function(o,n){if(1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"ul",5)(6,"li",6)(7,"a",7),t._uU(8,"Edici\xf3n de citas m\xe9dicas "),t.qZA()(),t.TgZ(9,"li",6),t._UZ(10,"i",8),t.qZA(),t.TgZ(11,"li",9),t._uU(12,"Editar Citas"),t.qZA()()()()(),t.TgZ(13,"div",3)(14,"div",4)(15,"div",10)(16,"div",11)(17,"form")(18,"div",12)(19,"div",13)(20,"div",14)(21,"h4"),t._uU(22,"Formulario edici\xf3n cita"),t.qZA()()(),t.TgZ(23,"div",15)(24,"div",16)(25,"label",17),t._uU(26,"Fecha de la cita "),t.TgZ(27,"span",18),t._uU(28,"*"),t.qZA()(),t.TgZ(29,"input",19),t.NdJ("ngModelChange",function(s){return n.date_appointment=s}),t.qZA(),t._UZ(30,"mat-datepicker-toggle",20)(31,"mat-datepicker",null,21),t.qZA()(),t.TgZ(33,"div",15)(34,"div",16)(35,"label"),t._uU(36,"Hora "),t.TgZ(37,"span",18),t._uU(38,"*"),t.qZA()(),t.TgZ(39,"mat-select",22),t.NdJ("ngModelChange",function(s){return n.hour=s}),t.YNc(40,j,2,2,"mat-option",23),t.qZA()()(),t.TgZ(41,"div",15)(42,"div",16)(43,"label"),t._uU(44,"Especialidades "),t.TgZ(45,"span",18),t._uU(46,"*"),t.qZA()(),t.TgZ(47,"mat-select",24),t.NdJ("ngModelChange",function(s){return n.specialitie_id=s}),t.YNc(48,z,2,2,"mat-option",23),t.qZA()()(),t.TgZ(49,"div",15)(50,"div",16)(51,"button",25),t.NdJ("click",function(){return n.filtrar()}),t._uU(52," Filtrar "),t.qZA()()()(),t.TgZ(53,"div",12),t.YNc(54,G,15,3,"div",26),t.TgZ(55,"div",27)(56,"div",28)(57,"table",29)(58,"thead")(59,"tr")(60,"th"),t._uU(61,"Doctor"),t.qZA(),t.TgZ(62,"th"),t._uU(63,"Disponibilidad"),t.qZA(),t.TgZ(64,"th"),t._uU(65,"Ver"),t.qZA()()(),t.TgZ(66,"tbody"),t.YNc(67,H,9,5,"ng-container",30),t.qZA()()()(),t.YNc(68,V,11,1,"div",31),t.qZA(),t.TgZ(69,"div",13),t.YNc(70,X,8,1,"div",32),t.YNc(71,tt,8,1,"div",32),t.qZA(),t.TgZ(72,"div",33)(73,"div",34)(74,"h4"),t._uU(75,"Datos del paciente"),t.qZA()(),t.TgZ(76,"div",35)(77,"div",16)(78,"label",36),t._uU(79,"Nombre "),t.TgZ(80,"span",18),t._uU(81,"*"),t.qZA()(),t.TgZ(82,"input",37),t.NdJ("ngModelChange",function(s){return n.name=s}),t.qZA()()(),t.TgZ(83,"div",35)(84,"div",16)(85,"label",38),t._uU(86,"Apellidos "),t.TgZ(87,"span",18),t._uU(88,"*"),t.qZA()(),t.TgZ(89,"input",39),t.NdJ("ngModelChange",function(s){return n.surname=s}),t.qZA()()(),t.TgZ(90,"div",35)(91,"div",16)(92,"label",40),t._uU(93,"DNI "),t.TgZ(94,"span",18),t._uU(95,"*"),t.qZA()(),t.TgZ(96,"input",41),t.NdJ("keyup.enter",function(){return n.dnifilter()})("ngModelChange",function(s){return n.DNI=s}),t.qZA()()(),t.TgZ(97,"div",35)(98,"div",16)(99,"label",42),t._uU(100,"M\xf3vil "),t.TgZ(101,"span",18),t._uU(102,"*"),t.qZA()(),t.TgZ(103,"input",43),t.NdJ("ngModelChange",function(s){return n.movil=s}),t.qZA()()()(),t.TgZ(104,"div",33),t._UZ(105,"div",35),t.qZA(),t.TgZ(106,"div",12)(107,"div",13)(108,"div",44)(109,"button",45),t.NdJ("click",function(){return n.save()}),t._uU(110," Guardar "),t.qZA()()()()()()()()()()()),2&o){const a=t.MAs(32);t.xp6(29),t.Q6J("ngModel",n.date_appointment)("matDatepicker",a)("matDatepickerFilter",n.dateFilter),t.xp6(1),t.Q6J("for",a),t.xp6(9),t.Q6J("ngModel",n.hour)("ngModelOptions",t.DdM(19,C)),t.xp6(1),t.Q6J("ngForOf",n.hours),t.xp6(7),t.Q6J("ngModel",n.specialitie_id)("ngModelOptions",t.DdM(20,C)),t.xp6(1),t.Q6J("ngForOf",n.specialities),t.xp6(6),t.Q6J("ngIf",n.appointment_selected),t.xp6(13),t.Q6J("ngForOf",n.DOCTORS),t.xp6(1),t.Q6J("ngIf",n.DOCTOR_SELECTED),t.xp6(2),t.Q6J("ngIf",n.text_success),t.xp6(1),t.Q6J("ngIf",n.text_validation),t.xp6(11),t.Q6J("ngModel",n.name),t.xp6(7),t.Q6J("ngModel",n.surname),t.xp6(7),t.Q6J("ngModel",n.DNI),t.xp6(7),t.Q6J("ngModel",n.movil)}},dependencies:[m.mk,m.sg,m.O5,g.Mq,g.hl,g.nW,T.R9,Z.gD,f.ey,l._Y,l.Fj,l.JJ,l.JL,l.Q7,l.On,l.F]})}return i})();var M=p(5313),x=p(3566);function nt(i,r){if(1&i&&(t.TgZ(0,"mat-option",46),t._uU(1),t.qZA()),2&i){const e=r.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}const it=function(){return{standalone:!0}};function ot(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",16)(1,"label"),t._uU(2,"Especialidades "),t.TgZ(3,"span",17),t._uU(4,"*"),t.qZA()(),t.TgZ(5,"mat-select",44),t.NdJ("ngModelChange",function(n){t.CHM(e);const a=t.oxw();return t.KtG(a.specialitie_id=n)}),t.YNc(6,nt,2,2,"mat-option",45),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(5),t.Q6J("ngModel",e.specialitie_id)("ngModelOptions",t.DdM(3,it)),t.xp6(1),t.Q6J("ngForOf",e.specialities)}}const at=function(i){return["/appointments-m/list/edit/",i]};function st(i,r){if(1&i&&(t.TgZ(0,"a",65),t._UZ(1,"i",66),t._uU(2," Modificar cita "),t.qZA()),2&i){const e=t.oxw(2).$implicit;t.Q6J("routerLink",t.VKq(1,at,e.id))}}function rt(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"a",67),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.selectUser(n))}),t._UZ(1,"i",68),t._uU(2," Eliminar"),t.qZA()}if(2&i){const e=t.oxw(2).$implicit;t.uIk("data-bs-target","#delete_staff-"+e.id)}}const lt=function(i){return["/appointments-m/list/attendance/",i]};function pt(i,r){if(1&i&&(t.TgZ(0,"a",65),t._UZ(1,"i",69),t._uU(2," Consulta "),t.qZA()),2&i){const e=t.oxw(2).$implicit;t.Q6J("routerLink",t.VKq(1,lt,e.id))}}function dt(i,r){if(1&i&&(t.TgZ(0,"div",59)(1,"a",60),t._UZ(2,"i",61),t.qZA(),t.TgZ(3,"div",62),t.YNc(4,st,3,3,"a",63),t.YNc(5,rt,3,1,"a",64),t.YNc(6,pt,3,3,"a",63),t.qZA()()),2&i){const e=t.oxw(2);t.xp6(4),t.Q6J("ngIf",e.isPermission("edit_appointment")),t.xp6(1),t.Q6J("ngIf",e.isPermission("delete_appointment")),t.xp6(1),t.Q6J("ngIf",e.isPermission("attention_appointment"))}}function ct(i,r){if(1&i&&(t.TgZ(0,"h3"),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.hij("\xbfSeguro quiere eliminar esta cita ",e.appointment_selected.email,"?")}}const mt=function(i,r){return{"status-pink":i,"status-green":r}};function ut(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td")(12,"button",47),t._uU(13),t.qZA()(),t.TgZ(14,"td"),t._uU(15),t.qZA(),t.TgZ(16,"td",48),t.YNc(17,dt,7,3,"div",49),t.qZA(),t.TgZ(18,"div",50)(19,"div",51)(20,"div",52)(21,"div",53),t._UZ(22,"img",54),t.YNc(23,ct,2,1,"h3",55),t.TgZ(24,"div",56)(25,"a",57),t._uU(26,"Close"),t.qZA(),t.TgZ(27,"button",58),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.deleteAppointment())}),t._uU(28,"Eliminar"),t.qZA()()()()()()()}if(2&i){const e=r.$implicit,o=t.oxw();t.xp6(2),t.Oqu((null==e||null==e.doctor?null:e.doctor.full_name)||"N/A"),t.xp6(2),t.Oqu((null==e||null==e.patient?null:e.patient.full_name)||"N/A"),t.xp6(2),t.Oqu((null==e?null:e.date_appointment_format)||"N/A"),t.xp6(2),t.Oqu(null!=e&&null!=e.segment_hour&&null!=e.segment_hour.formatted_segment&&e.segment_hour.formatted_segment.formatted_hour_start&&null!=e&&null!=e.segment_hour&&null!=e.segment_hour.formatted_segment&&e.segment_hour.formatted_segment.formatted_hour_end?e.segment_hour.formatted_segment.formatted_hour_start+"-"+e.segment_hour.formatted_segment.formatted_hour_end:"N/A"),t.xp6(2),t.Oqu((null==e||null==e.specialitie?null:e.specialitie.name)||"N/A"),t.xp6(2),t.Q6J("ngClass",t.WLB(11,mt,1===e.status,2===e.status)),t.xp6(1),t.Oqu(1==e.status?"PENDIENTE":"ATENDIDO"),t.xp6(2),t.Oqu((null==e?null:e.created_at)||"N/A"),t.xp6(2),t.Q6J("ngIf",1!=e.id),t.xp6(1),t.uIk("id","delete_staff-"+e.id),t.xp6(5),t.Q6J("ngIf",o.appointment_selected)}}function _t(i,r){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"li",70)(2,"a",43),t.NdJ("click",function(){const a=t.CHM(e).$implicit,s=t.oxw();return t.KtG(s.moveToPage(a))}),t._uU(3),t.qZA()(),t.BQk()}if(2&i){const e=r.$implicit,o=t.oxw();t.xp6(1),t.ekj("active",e===o.currentPage),t.xp6(2),t.Oqu(e)}}const U=function(i){return{disabled:i}},gt=[{path:"",component:I,children:[{path:"register",component:w},{path:"list",component:(()=>{class i{constructor(e){this.appointmentService=e,this.appointmentList=[],this.showFilter=!1,this.searchDataValue="",this.specialitie_id="",this.date=null,this.lastIndex=0,this.pageSize=10,this.totalData=0,this.skip=0,this.limit=this.pageSize,this.pageIndex=0,this.serialNumberArray=[],this.currentPage=1,this.pageNumberArray=[],this.pageSelection=[],this.totalPages=0,this.patient_generals=[],this.specialities=[]}ngOnInit(){this.getTableData(),this.user=this.appointmentService.authService.user,this.appointmentService.listConfig().subscribe(e=>{this.specialities=e.specialities})}isPermission(e){return!(!this.user.roles.includes("Super-Admin")&&!this.user.permission.includes(e))}isPermited(){let e=!1;return this.user.roles.forEach(o=>{-1!=o.toUpperCase().indexOf("ESPECIALISTA")&&(e=!0)}),e}getTableData(e=1){this.appointmentList=[],this.serialNumberArray=[],this.appointmentService.listAppointments(e,this.searchDataValue,this.specialitie_id,this.date).subscribe(o=>{console.log(o),this.totalData=o.total,this.appointmentList=o.appointments.data,this.dataSource=new M.by(this.appointmentList),this.calculateTotalPages(this.totalData,this.pageSize)})}getTableDataGeneral(){this.appointmentList=[],this.serialNumberArray=[],this.patient_generals.map((e,o)=>{const n=o+1;o>=this.skip&&n<=this.limit&&(this.appointmentList.push(e),this.serialNumberArray.push(n))}),this.dataSource=new M.by(this.appointmentList),this.calculateTotalPages(this.totalData,this.pageSize)}selectUser(e){this.appointment_selected=e}deleteAppointment(){this.appointmentService.deleteAppointment(this.appointment_selected.id).subscribe(e=>{console.log(e);let o=this.appointmentList.findIndex(n=>n.id==this.appointment_selected.id);-1!=o&&(this.appointmentList.splice(o,1),$("#delete_appointment").hide(),$("#delete_appointment").removeClass("show"),$(".modal-backdrop").remove(),$("body").removeClass(),$("body").removeAttr("style"),this.appointment_selected=null)})}searchData(){this.pageSelection=[],this.limit=this.pageSize,this.skip=0,this.currentPage=1,this.getTableData()}sortData(e){const o=this.appointmentList.slice();this.appointmentList=e.active&&""!==e.direction?o.sort((n,a)=>(n[e.active]<a[e.active]?-1:1)*("asc"===e.direction?1:-1)):o}getMoreData(e){"next"===e?this.currentPage<this.totalPages&&(this.currentPage++,this.pageIndex=this.currentPage-1,this.skip=this.pageSize*this.pageIndex,this.limit=this.pageSize,this.getTableData()):"previous"===e&&this.currentPage>1&&(this.currentPage--,this.pageIndex=this.currentPage-1,this.skip=this.pageSize*this.pageIndex,this.limit=this.pageSize,this.getTableData())}moveToPage(e){this.currentPage=e,this.skip=this.pageSelection[e-1].skip,this.limit=this.pageSelection[e-1].limit,e>this.currentPage?this.pageIndex=e-1:e<this.currentPage&&(this.pageIndex=e+1),this.getTableData()}PageSize(){this.pageSelection=[],this.limit=this.pageSize,this.skip=0,this.currentPage=1,this.getTableData()}calculateTotalPages(e,o){this.pageNumberArray=[],this.totalPages=e/o,this.totalPages%1!=0&&(this.totalPages=Math.trunc(this.totalPages)+1);for(let n=1;n<=this.totalPages;n++){const a=o*n,s=a-o;this.pageNumberArray.push(n),this.pageSelection.push({skip:s,limit:a})}}static#t=this.\u0275fac=function(o){return new(o||i)(t.Y36(v))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-list-appointments"]],decls:76,vars:13,consts:[[1,"page-wrapper"],[1,"content"],[1,"page-header"],[1,"row"],[1,"col-sm-12"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],[1,"feather","icon-chevron-right"],[1,"breadcrumb-item","active"],[1,"card","card-table","show-entire"],[1,"card-body"],[1,"page-table-header","mb-2"],[1,"row","align-items-center"],[1,"col"],["class","form-group local-forms",4,"ngIf"],[1,"form-group","local-forms"],[1,"login-danger"],["name","date","type","date",1,"form-control",3,"ngModel","ngModelChange"],[1,"add-group"],["href","#","onclick","return false;",1,"btn","btn-dark","add-pluss","ms-2",3,"click"],["routerLink","/appointments-m/register",1,"btn","btn-primary","add-pluss","ms-2"],["src","assets/img/icons/plus.svg","alt",""],["href","javascript:;",1,"btn","btn-primary","doctor-refresh","ms-2",3,"click"],["src","assets/img/icons/re-fresh.svg","alt",""],[1,"col-auto","text-end","float-end","ms-auto","download-grp"],[1,"table-responsive"],["matSort","",1,"table","mb-0","border-0","datatable","custom-table",3,"matSortChange"],["mat-sort-header","name"],["mat-sort-header","email"],["mat-sort-header","fecha_nac"],["mat-sort-header","movil"],["mat-sort-header","DNI"],["mat-sort-header","status"],["mat-sort-header","created_at"],[4,"ngFor","ngForOf"],[1,"table_footer"],[1,"col-sm-12","col-md-5"],[1,"dataTables_info"],[1,"col-sm-12","col-md-7"],[1,"pagination_section"],[1,"pagination"],[1,"page-item",3,"ngClass"],["href","javascript:void(0);",1,"page-link",3,"click"],["placeholder","Seleccione una especialidad",1,"form-control","select",3,"ngModel","ngModelOptions","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"custom-badge",3,"ngClass"],[1,"text-end"],["class","dropdown dropdown-action",4,"ngIf"],["role","dialog",1,"modal","fade","delete-modal"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-body","text-center"],["src","assets/img/sent.png","alt","","width","50","height","46"],[4,"ngIf"],[1,"m-t-20"],["href","javascript:void(0);","data-bs-dismiss","modal",1,"btn","btn-white","me-1"],["type","submit",1,"btn","btn-danger",3,"click"],[1,"dropdown","dropdown-action"],["href","javascript:void(0);","data-bs-toggle","dropdown","aria-expanded","false",1,"action-icon","dropdown-toggle"],[1,"fa","fa-ellipsis-v"],[1,"dropdown-menu","dropdown-menu-end"],["class","dropdown-item",3,"routerLink",4,"ngIf"],["class","dropdown-item","href","javascript:void(0);","data-bs-toggle","modal",3,"click",4,"ngIf"],[1,"dropdown-item",3,"routerLink"],[1,"fa-solid","fa-pen-to-square","m-r-5"],["href","javascript:void(0);","data-bs-toggle","modal",1,"dropdown-item",3,"click"],[1,"fa","fa-trash-alt","m-r-5"],[1,"fa-solid","fa-notes-medical"],[1,"page-item"]],template:function(o,n){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"ul",5)(6,"li",6)(7,"a",7),t._uU(8,"Citas"),t.qZA()(),t.TgZ(9,"li",6),t._UZ(10,"i",8),t.qZA(),t.TgZ(11,"li",9),t._uU(12,"Listado de Citas de Pacientes"),t.qZA()()()()(),t.TgZ(13,"div",3)(14,"div",4)(15,"div",10)(16,"div",11)(17,"div",12)(18,"div",13)(19,"div",14)(20,"h3"),t._uU(21,"Listado de Citas "),t.qZA()(),t.TgZ(22,"div",14),t.YNc(23,ot,7,4,"div",15),t.qZA(),t.TgZ(24,"div",14)(25,"div",16)(26,"label"),t._uU(27,"Fecha "),t.TgZ(28,"span",17),t._uU(29,"*"),t.qZA()(),t.TgZ(30,"input",18),t.NdJ("ngModelChange",function(s){return n.date=s}),t.qZA()()(),t.TgZ(31,"div",14)(32,"div",19)(33,"a",20),t.NdJ("click",function(){return n.searchData()}),t._uU(34,"Filtrar"),t.qZA(),t.TgZ(35,"a",21),t._UZ(36,"img",22),t.qZA(),t.TgZ(37,"a",23),t.NdJ("click",function(){return n.PageSize()}),t._UZ(38,"img",24),t.qZA()()(),t._UZ(39,"div",25),t.qZA()(),t.TgZ(40,"div",26)(41,"table",27),t.NdJ("matSortChange",function(s){return n.sortData(s)}),t.TgZ(42,"thead")(43,"tr")(44,"th",28),t._uU(45,"Profesional"),t.qZA(),t.TgZ(46,"th",29),t._uU(47,"Paciente"),t.qZA(),t.TgZ(48,"th",30),t._uU(49,"Fecha"),t.qZA(),t.TgZ(50,"th",31),t._uU(51,"Hora"),t.qZA(),t.TgZ(52,"th",32),t._uU(53,"Especialidad"),t.qZA(),t.TgZ(54,"th",33),t._uU(55,"Status"),t.qZA(),t.TgZ(56,"th",34),t._uU(57,"Fecha de Registro"),t.qZA(),t.TgZ(58,"th"),t._uU(59,"Acciones"),t.qZA()()(),t.TgZ(60,"tbody"),t.YNc(61,ut,29,14,"tr",35),t.qZA()()(),t.TgZ(62,"div",36)(63,"div",37)(64,"div",38),t._uU(65),t.qZA()(),t.TgZ(66,"div",39)(67,"div",40)(68,"ul",41)(69,"li",42)(70,"a",43),t.NdJ("click",function(){return n.getMoreData("previous")}),t._uU(71,"Anterior"),t.qZA()(),t.YNc(72,_t,4,3,"ng-container",35),t.TgZ(73,"li",42)(74,"a",43),t.NdJ("click",function(){return n.getMoreData("next")}),t._uU(75,"Siguiente"),t.qZA()()()()()()()()()()()()),2&o&&(t.xp6(23),t.Q6J("ngIf",!n.isPermited()),t.xp6(7),t.Q6J("ngModel",n.date),t.xp6(31),t.Q6J("ngForOf",n.appointmentList),t.xp6(4),t.lnq(" Mostrando ",n.serialNumberArray[0]," a ",n.serialNumberArray[n.serialNumberArray.length-1]," de ",n.totalData," entradas "),t.xp6(4),t.Q6J("ngClass",t.VKq(9,U,1===n.currentPage)),t.xp6(3),t.Q6J("ngForOf",n.pageNumberArray),t.xp6(1),t.Q6J("ngClass",t.VKq(11,U,n.currentPage===n.pageNumberArray[n.pageNumberArray.length-1]||0===n.appointmentList.length)))},dependencies:[m.mk,m.sg,m.O5,_.rH,Z.gD,f.ey,x.YE,x.nU,l.Fj,l.JJ,l.On]})}return i})()},{path:"list/edit/:id",component:et},{path:"list/attendance/:id",component:R}]}];let ht=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({imports:[_.Bz.forChild(gt),_.Bz]})}return i})();var ft=p(8188);let vt=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({imports:[m.ez,ht,ft.m,l.u5,l.UX,c.JF,_.Bz]})}return i})()}}]);